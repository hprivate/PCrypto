"""
å…è´£å£°æ˜ï¼š
æœ¬è„šæœ¬ä¸­çš„å‚æ•°å’Œé¢˜ç›®æ¥æºäºç½‘ç»œï¼Œä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚å¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»åˆ é™¤ã€‚
æˆ‘ä»¬ä¸å¯¹å› ä½¿ç”¨æ­¤è„šæœ¬è€Œå¯¼è‡´çš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå®³æ‰¿æ‹…è´£ä»»ã€‚
è„šæœ¬ç”± ChatGPT è¾…åŠ©ç¼–å†™
"""

# åœ¨RSAåŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ä¸­ï¼Œå…¬é’¥ç”±(ğ‘›,ğ‘’)ç»„æˆï¼Œç§é’¥ç”±(ğ‘›,ğ‘‘)ç»„æˆï¼Œå…¶ä¸­ ğ‘›=ğ‘Ã—ğ‘ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç§é’¥çš„æŒ‡æ•°ğ‘‘ï¼Œç„¶åä½¿ç”¨å®ƒæ¥è§£å¯†æ¶ˆæ¯ã€‚
# n = p*q
# Ï•(n)=(pâˆ’1)(qâˆ’1)

from sympy import mod_inverse

def rsa_generate_keys(p, q, e):
    # è®¡ç®— n
    n = p * q
    
    # è®¡ç®— Ï†(n)
    phi_n = (p - 1) * (q - 1)
    
    # è®¡ç®— d (e åœ¨æ¨¡ Ï†(n) æ„ä¹‰ä¸‹çš„é€†å…ƒ)
    d = mod_inverse(e, phi_n)
    
    return n, d
    
def rsa_decrypt(n, d, c):
    # ä½¿ç”¨ç§é’¥ (n, d) è§£å¯†æ¶ˆæ¯ c
    m = pow(c, d, n)
    return m

# ç»™å®šå‚æ•°
p = 9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
q = 11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
e = 65537

# ç”Ÿæˆå¯†é’¥å¯¹
n, d = rsa_generate_keys(p, q, e)
print(f"n: {n}")
print(f"d: {d}")

# ç¤ºä¾‹å¯†æ–‡ (ä½ å¯ä»¥æ›¿æ¢æˆä½ çš„å¯†æ–‡)
c = 83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034  # ç¤ºä¾‹å¯†æ–‡ï¼Œéœ€è¦æ›¿æ¢ä¸ºå®é™…å¯†æ–‡

# è§£å¯†æ¶ˆæ¯
decrypted_message = rsa_decrypt(n, d, c)
print("è§£å¯†åçš„æ¶ˆæ¯:", decrypted_message)